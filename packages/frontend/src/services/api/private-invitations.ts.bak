import axios from "axios";
import type {
  CreatePrivateInvitationInput,
  CancelPrivateInvitationInput,
  PrivateInvitation,
  ApiResponse,
  PaginatedResponse,
} from "@spanish-class/shared";

const API_URL = import.meta.env.VITE_API_URL || "http://localhost:3000/api";

// T014: API client for private invitations

export async function createPrivateInvitation(
  data: CreatePrivateInvitationInput,
): Promise<
  ApiResponse<{
    slot: any;
    booking: any;
    meetLink: string;
  }>
> {
  const response = await axios.post(
    `${API_URL}/professor/private-invitations`,
    data,
    { withCredentials: true },
  );
  return response.data;
}

export async function listPrivateInvitations(params?: {
  page?: number;
  limit?: number;
  startDate?: string;
  endDate?: string;
}): Promise<PaginatedResponse<any>> {
  const response = await axios.get(`${API_URL}/professor/private-invitations`, {
    params,
    withCredentials: true,
  });
  return response.data;
}

export async function cancelPrivateInvitation(
  id: string,
  data?: CancelPrivateInvitationInput,
): Promise<ApiResponse> {
  const response = await axios.delete(
    `${API_URL}/professor/private-invitations/${id}`,
    {
      data,
      withCredentials: true,
    },
  );
  return response.data;
}
